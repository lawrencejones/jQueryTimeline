(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;l=function(e,t,n,r,i){var s,o,u,a,f,l;s=p(r);a=3;l=N(e);o=N(t);A(s,l,o,a,i);u=L(e,t,n);return f=g(s,u,v,m)};d=function(e,t,n,r,i,s){var o;o=l(e,t,n,r,s);return h(i,o)};h=function(e,t){var n,i,s,o,u,a;t.data("moments",e);for(i=0,o=e.length;i<o;i++){n=e[i];n=c(n,t)}e=r(e,t);console.log(e.length);a=[];for(s=0,u=e.length;s<u;s++){n=e[s];a.push(n.lblContainer.delay(1700).fadeIn({duration:600,complete:function(){var t,r,i;i=[];for(t=0,r=e.length;t<r;t++){n=e[t];i.push(n.animateStartWire())}return i}}))}return a};c=function(e,t){var n;n=E(t);o(e,t);return u(e,t)};A=function(e,t,n,r,i){return e.data({utils:{startDate:t,endDate:n,markerLeftBuffer:r,spineWidth:this.spineWidth!=null?100:void 0,structure:i,dateToMarkerNo:function(e){return Math.floor((e-this.startDate)/(1e3*60*60*24))},noOfIntervals:function(){return 1+this.dateToMarkerNo(this.endDate)},dateToMarkerLeft:function(e){if(typeof e==="string"){e=N(e)}return this.markerLeftBuffer+this.pctPerInterval()*this.dateToMarkerNo(e)+"%"},pctPerInterval:function(){return(100-this.markerLeftBuffer)/(this.noOfIntervals()-1)},toString:function(){return"Start : "+this.startDate+" 				\nEnd : "+this.endDate+"  				\nMarkers left buffer : "+this.markerLeftBuffer+" 				\nNo Of Intervals : "+this.noOfIntervals()+"  				\nPercent per Interval : "+this.pctPerInterval().toFixed(3)}}})};L=function(e,t,n){var r,i,s;e=N(e);t=N(t);r=[];while(e<=t){r.push({date:e.getDate(),day:e.getDay(),month:e.getMonth(),year:1900+e.getYear(),toString:function(){return this.date+"/"+this.month+"/"+this.year+" day is "+this.day}});e.setDate(e.getDate()+1)}for(i=0,s=r.length;i<s;i++){n=r[i];O(n)}return r};O=function(e){var t;t={};if(e["date"]==null){if(typeof e==="string"){e=N(e)}t.day=e.getDay();t.date=e.getDate();t.month=e.getMonth();e=t}if(e.date===1){return e.priority=3}else if(e.day===1){return e.priority=2}else{return e.priority=1}};r=function(t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v;a=E(n);M(t);u=[];r=[];for(l=0,p=t.length;l<p;l++){s=t[l];s.isExpanded=false}o=function(e,t,n,r){e.up=t%2===0;if(e.up){return n.push(e)}else{return r.push(e)}};for(i=c=0,d=t.length;c<d;i=++c){s=t[i];o(s,i,u,r)}n.data("ups",u);n.data("downs",r);f=function(e){var t,r;e.spine=n;e.lblWidth=function(){return parseFloat(this._width)};e.lblHeight=function(){return this._height};e.top=function(){return parseFloat(this._top)};if((t=e._marginLeft)==null){e._marginLeft=16}e.bottom=function(){return parseFloat(this.top()+parseFloat(this.lblHeight()))};e.leftmost=function(){return this.leftPctNum-this.pctOffset()+"%"};e.rightmost=function(){return parseFloat(this.leftmost())+this.pctWidth()+"%"};if((r=e.leftPctNum)==null){e.leftPctNum=parseFloat(a.dateToMarkerLeft(this.start))}e.pctWidth=function(){return 100*this.lblWidth()/(this.spine.data("widthPct")/100*this.spine.parent().width())};e.pctOffset=function(){var e,t;e=parseFloat(this._marginLeft);t=this.spine.data("widthPct")/100*this.spine.parent().width();return 100*(e/t)};e.inVerticalRange=function(e){var t,n;return this.top()<=(t=e.top())&&t<=this.bottom()||this.top()<=(n=e.bottom())&&n<=this.bottom()};e.inHorizontalRange=function(e){return parseFloat(this.leftmost()<=parseFloat(e.leftmost()<=parseFloat(this.rightmost())))||parseFloat(this.leftmost()<=parseFloat(e.rightmost()<=parseFloat(this.rightmost())))};return e.clash=function(e){return this.inVerticalRange(e)&&this.inHorizontalRange(e)}};for(h=0,v=t.length;h<v;h++){s=t[h];f(s)}return e(t)};e=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g;s=e[0].spine;u=E(s);o=s.data("ups");n=s.data("downs");for(l=0,d=e.length;l<d;l++){r=e[l];if(r.isExpanded){r._marginLeft=r.expanded.marginLeft;r._width=r.expanded.width;r._height=r.expanded.height}else{r._marginLeft=r.collapsed.marginLeft;r._width=r.collapsed.width;r._height=r.collapsed.height}}a=function(e){var t,n,r,i,s;i=N(e.start);n=Math.floor((e.leftPctNum-parseFloat(e.leftmost()))/u.pctPerInterval())+1;s=Math.floor((parseFloat(e.rightmost())-e.leftPctNum)/u.pctPerInterval())+1;r=new Date(i);r.setDate(i.getDate()-n);i.setDate(i.getDate()+s);t=[];while(r<=i){t.push(O(r));r.setDate(r.getDate()+1)}e.priority=Math.max.apply(Math,t);return console.log("From "+t+" we got "+e.priority)};for(c=0,v=e.length;c<v;c++){r=e[c];a(r)}f=function(e){var t;t=0;if(e.up){switch(e.priority){case 3:t=-35;break;case 2:t=-30;break;case 1:t=-23}t=t-parseFloat(e._height)}else{switch(e.priority){case 3:t=20;break;case 2:t=16;break;case 1:t=12}}return e._top=t};for(h=0,m=e.length;h<m;h++){r=e[h];f(r)}t=function(e,n){var i;i=function(){var t,i,s;s=[];for(t=0,i=n.length;t<i;t++){r=n[t];if(e.clash(r)){s.push(r)}}return s}();if(i.length>0){if(!r.up){e._top=i[0]._top+4+e._height}else{e._top=i[0]._top-4-e._height}return t(e,n)}};i=function(e){var n,i,s,o,u;u=[];for(n=s=0,o=e.length;s<o;n=++s){r=e[n];u.push(t(r,function(){var t,n,s;s=[];for(n=0,t=e.length;n<t;n++){i=e[n];if(i!==r){s.push(i)}}return s}()))}return u};i(o);i(n);for(p=0,g=e.length;p<g;p++){r=e[p];_(r)}return e};_=function(e){var t;t=e.lblContainer;t.animate({height:e._height,width:e._width,marginLeft:e._marginLeft,top:e._top+"px"},{duration:200});if(e.startWire.height()!==0){return e.animateStartWire()}};T=function(e){return"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Aug,Nov,Dec".split(",")[e]};M=function(e){return e.sort(function(e,t){if(N(e.start)<N(t.start)){return-1}else{return 1}})};y=function(e){return e.parent()};E=function(e){if(e.hasClass("spine")){return e.parent().data("utils")}else{return e.data("utils")}};b=function(){return"timeline_"+$(".timeline").length+1};N=function(e){var t;t=e.match(/(\d+)/g);return new Date(t[0],t[1]-1,t[2])};p=function(e){var t;e.append(t=$(document.createElement("div")));return t.attr({id:b(),"class":"timelineContainer"}).css({position:"absolute",minHeight:"150px",height:"auto",width:"100%",backgroundColor:"white"})};g=function(e,t,n,r){var i,s,o;i=7;s=3;o=$(document.createElement("div")).data({leftBuffer:i,rightBuffer:s});e.append(o);o.data("widthPct",100-(s+i));o.attr({"class":"spine"}).css({position:"absolute",width:"0%",height:"1px","margin-top":"50%","margin-left":i+"%","margin-right":s+"%",backgroundColor:"black"}).animate({width:100-(s+i)+"%"},{duration:1e3,complete:function(){return o.find(".intMarker").delay(800).fadeIn(600)}});return n(o,t,r)};m=function(e){var t;t=y(e);t.append(S(12,"black").addClass("originCircle").css({opacity:0,top:"50%",left:e.data("leftBuffer")+"%"}));t.find(".originCircle").animate({opacity:1},{duration:"300",easing:"easeInBounce"});return e};S=function(e,t,n){var r;if(n==null){n=true}s(r=$(document.createElement("div")).css({background:t,zIndex:10,height:e+"px",width:e+"px",position:"absolute","-moz-border-radius":e+"px","-webkit-border-radius":e+"px"}));if(n){r.css({"-webkit-box-shadow":"0 0 1px black","-moz-box-shadow":"0 0 1px black",boxShadow:"0 0 1px black"})}return r};s=function(e){return e.css({"margin-top":-e.height()/2+"px","margin-left":-e.width()/2+"px"})};t=function(e,t,n){return e.animate({height:t+"px",width:t+"px","-moz-border-radius":t+"px","-webkit-border-radius":t+"px","margin-top":-t/2+"px","margin-left":-t/2+"px"},{duration:n})};v=function(e,t,n){var r,s,o,u,a,f,l,c,h,p,d,v,m;p=new Date;s=function(e){var t;switch(e.priority){case 3:t={w:3,h:19,c:"black"};break;case 2:t={w:2,h:11,c:"black"};break;case 1:t={w:1,h:5,c:"black"}}if(e.date===p.getDate()&&e.month===p.getMonth()){t.c="blue";if(t.h<15){t.h=15}}return t};d=E(y(e));o=d.markerLeftBuffer;c=d.pctPerInterval();for(u=v=0,m=t.length;v<m;u=++v){a=t[u];h=3+u*c+"%";(l=x(s(a))).css({left:h});e.append(l);r=function(e){var t;t=e.data("finalHeight");return e.delay(1200).animate({height:t,marginTop:-t/2},{duration:300})};r(l);f=i(a);if(f!=null){e.append(f.css("left",h));f.hide()}}return n(e)};x=function(e){var t,n;t=e["h"];n=e["w"];return $(document.createElement("div")).css({position:"absolute",top:0,marginTop:0,"margin-left":-n/2,height:0,width:n,backgroundColor:e["c"]}).data("finalHeight",t)};i=function(e){var t,n;t=$(document.createElement("div")).css({marginTop:-14,width:40,marginLeft:-20,textAlign:"center",height:"auto",fontFamily:"Helvetica Neue",fontSize:"7px",position:"absolute"}).addClass("intMarker");n="";switch(e.priority){case 3:n=T(e.month);t.css({marginTop:-20,fontSize:9,fontWeight:"bold"});break;case 2:n="Mon "+e.date;break;case 1:return null}return t.text(n)};o=function(e,t){var n,r,i,s;s=E(t);i=s.dateToMarkerLeft(N(e.start));n=s.dateToMarkerLeft(N(e.end));t.append((e.startDot=S(7,"blue")).delay(1400).css("left",0).animate({left:i},{duration:400}));t.append((e.endDot=S(7,"red")).delay(1400).css("left",0).animate({left:n},{duration:400}).hide());t.append(e.duration=f(e,E(t),"green"));t.append(r=S(14,"white").css({opacity:0,left:i}));return e.hoverAnimation={"in":e.duration.data("slideIn"),out:e.duration.data("slideOut")}};f=function(e,t,n){var r,i,s,o;r=t.dateToMarkerLeft(N(e.start));s=t.dateToMarkerLeft(N(e.end));o=parseFloat(s)-parseFloat(r)+"%";return i=$(document.createElement("div")).css({height:2,width:0,position:"absolute",left:r,zIndex:5,backgroundColor:n}).data({slideIn:function(){if(!i.hasClass("inTransition")){i.addClass("inTransition").stop().css("width",0).animate({width:o},{duration:300,complete:function(){return i.removeClass("inTransition")}});return e.endDot.fadeIn(300)}},slideOut:function(){var t;t=0;if(i.hasClass("inTransition")){t=200}e.endDot.delay(t).stop().fadeOut(300);return i.delay(t).stop().addClass("inTransition").animate({width:0},{duration:300}).removeClass("inTransition")}})};u=function(t,r){var i,s;s=E(r).dateToMarkerLeft(t.start);r.append(i=$(document.createElement("div")));i.addClass("infoBox").css("left",s).click(function(){t.isExpanded=!t.isExpanded;e(r.data("moments"));if(t.isExpanded){return n(t,E(r))}else{return t.removeEndWires()}}).hover(t.hoverAnimation["in"],t.hoverAnimation.out);k(t,i,E(r).structure,E(r)).hide();i.css("margin-left",-i.width()/2).data("defaultLeft",s);t.leftPctNum=parseFloat(s);a(t,r,s);t.lblContainer=i;return t};a=function(e,t,n){var r;t.append(r=$(document.createElement("div")));r.addClass("wire").css({position:"absolute",width:"1",backgroundColor:"black",left:n,top:0,"-webkit-box-shadow":"0 0 1px blue",height:0,"-moz-box-shadow":"0 0 1px blue",boxShadow:"0 0 1px blue"});e.startWire=r;return e.animateStartWire=function(){if(this.up){return this.startWire.stop().animate({height:Math.abs(this.bottom()),top:this.bottom()},{duration:200,easing:"linear"})}else{return this.startWire.animate({height:this.top()},{duration:200})}}};k=function(e,t,n,r){var i,s,o,u,a,f;u="";for(i=a=0,f=n.title.length-2;0<=f?a<=f:a>=f;i=0<=f?++a:--a){s=n.title[i];if(e[s]!=null){u+=e[s]+":"}}u+=e[n.title[n.title.length-1]];o=$(document.createElement("span")).css("display","inline").text(u).addClass("title").appendTo(t);e.collapsed={height:t.height(),width:t.width(),marginLeft:-t.width()/2};return C(e,o,t,n,r)};C=function(e,t,n,r,i){var s,o,u,a,f,l,c,h;if(r.extendedTitle.length!==0){a+=" - ";for(o=f=0,c=r.extendedTitle.length-2;0<=c?f<=c:f>=c;o=0<=c?++f:--f){u=r.extendedTitle[o];if(e.key!=null){a+=e[u]+", "}}a+=e[r.extendedTitle[r.extendedTitle.length-1]]}t.text(a);a="";n.html(n.html()+"<br>");s=$(document.createElement("span")).css({whiteSpace:"nowrap",fontSize:"10px",fontFamily:"'Helvetica Neue', Helvetica, Arial, sans-serif"}).appendTo(n);for(o=l=0,h=r.content.length-2;0<=h?l<=h:l>=h;o=0<=h?++l:--l){u=r.content[o];if(e[u]!=null){a+=e[u]+" / "}}a+=e[r.content[r.content.length-1]];s.text(a);e.expanded={height:n.height(),width:n.width(),marginLeft:e.collapsed.marginLeft};return n.css({height:e.collapsed.height,width:e.collapsed.width,marginLeft:e.collapsed.marginLeft})};n=function(e,t){var n,r,i,s,o,u,a,f,l;o=e.startWire;i=parseFloat(t.dateToMarkerLeft(e.start));s=parseFloat(t.dateToMarkerLeft(e.end));u=e.top()+e.lblHeight()/2;f=Math.abs(u);if(e.up){l=u}else{l=0}a=$(document.createElement("div")).css({position:"absolute",width:"1px",backgroundColor:"black",left:s+"%",height:0,top:u,"-webkit-box-shadow":"0 0 1px red","-moz-box-shadow":"0 0 1px red",boxShadow:"0 0 1px red"}).appendTo(e.spine);r=$(document.createElement("div")).css({position:"absolute",height:"1px",backgroundColor:"black",left:i+"%",width:0,top:u,"-webkit-box-shadow":"0 0 1px red","-moz-box-shadow":"0 0 1px red",boxShadow:"0 0 1px red"}).appendTo(e.spine);n=S(3,"black",false).css({left:s+"%",top:r.css("top")});r.animate({width:s-i+"%"},{complete:function(){n.appendTo(e.spine);return a.animate({height:f,top:l},{duration:200})}});return e.removeEndWires=function(){a.remove();r.remove();return n.remove()}};$(function(){var e,t,n,r;r=["2013-01-07","2013-03-27"],n=r[0],t=r[1];e={title:["id","type"],extendedTitle:[],content:["spec","givens","notes"]};return d(n,t,"day",$("#container"),w(),e)})}).call(this)