(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;c=function(e,t,n,r,i){var s,o,u,a,f,l;s=d(r);a=3;l=T(e);o=T(t);L(s,l,o,a,i);u=k(e,t,n);return f=g(s,u,v,m)};window.createTimelineWithMoments=function(e,t,n,r,s,o){var u,a,f,l;if(e!=null&&t!=null&&n!=null&&r!=null&&s!=null&&s[0]!=null&&o!=null){a=c(e,t,n,r,o);for(f=0,l=s.length;f<l;f++){u=s[f];u.spine=a}p(s,a);i(a.parent().data("originCircle"),s,a);return a.parent()}else{console.log("One of the initial variables is invalid.");return console.log(s.length)}};p=function(e,t){var n,i,s,o,u,a;t.data("moments",e);for(i=0,o=e.length;i<o;i++){n=e[i];n=h(n,t)}e=r(e,t);a=[];for(s=0,u=e.length;s<u;s++){n=e[s];a.push(n.lblContainer.delay(1700).fadeIn({duration:600,complete:function(){var t,r,i;i=[];for(t=0,r=e.length;t<r;t++){n=e[t];i.push(n.animateStartWire())}return i}}))}return a};h=function(e,t){var n;n=w(t);u(e,t);return a(e,t)};L=function(e,t,n,r,i){return e.data({utils:{startDate:t,endDate:n,markerLeftBuffer:r,spineWidth:this.spineWidth!=null?100:void 0,structure:i,dateToMarkerNo:function(e){return Math.floor((e-this.startDate)/(1e3*60*60*24))},noOfIntervals:function(){return 1+this.dateToMarkerNo(this.endDate)},dateToMarkerLeft:function(e){if(typeof e==="string"){e=T(e)}return this.markerLeftBuffer+this.pctPerInterval()*this.dateToMarkerNo(e)+"%"},pctPerInterval:function(){return(100-this.markerLeftBuffer)/(this.noOfIntervals()-1)}}})};k=function(e,t,n){var r,i,s;e=T(e);t=T(t);r=[];while(e<=t){r.push({date:e.getDate(),day:e.getDay(),month:e.getMonth(),year:1900+e.getYear()});e.setDate(e.getDate()+1)}for(i=0,s=r.length;i<s;i++){n=r[i];A(n)}return r};A=function(e){var t;t={};if(e["date"]==null){if(typeof e==="string"){e=T(e)}t.day=e.getDay();t.date=e.getDate();t.month=e.getMonth();e=t}if(e.date===1){return e.priority=3}else if(e.day===1){return e.priority=2}else{return e.priority=1}};r=function(t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v;a=w(n);O(t);u=[];r=[];for(l=0,p=t.length;l<p;l++){s=t[l];s.isExpanded=false}o=function(e,t,n,r){e.up=t%2===0;if(e.up){return n.push(e)}else{return r.push(e)}};for(i=c=0,d=t.length;c<d;i=++c){s=t[i];o(s,i,u,r)}n.data("ups",u);n.data("downs",r);f=function(e){var t,r;e.spine=n;e.lblWidth=function(){return parseFloat(this._width)};e.lblHeight=function(){return this._height};e.top=function(){return parseFloat(this._top)};if((t=e._marginLeft)==null){e._marginLeft=16}e.bottom=function(){return parseFloat(this.top()+parseFloat(this.lblHeight()))};e.leftmost=function(){return this.leftPctNum-this.pctOffset()+"%"};e.rightmost=function(){return parseFloat(this.leftmost())+this.pctWidth()+"%"};if((r=e.leftPctNum)==null){e.leftPctNum=parseFloat(a.dateToMarkerLeft(this.start))}e.pctWidth=function(){return 100*this.lblWidth()/(this.spine.data("widthPct")/100*this.spine.parent().width())};e.pctOffset=function(){var e,t;e=parseFloat(this._marginLeft);t=this.spine.data("widthPct")/100*this.spine.parent().width();return 100*(e/t)};e.inVerticalRange=function(e){var t,n;return this.top()<=(t=e.top())&&t<=this.bottom()||this.top()<=(n=e.bottom())&&n<=this.bottom()};e.inHorizontalRange=function(e){var t,n,r,i;t=parseFloat(this.leftmost())<=(r=parseFloat(e.leftmost()))&&r<=parseFloat(this.rightmost());n=parseFloat(this.leftmost())<=(i=parseFloat(e.rightmost()))&&i<=parseFloat(this.rightmost());return t||n};return e.clash=function(e){return this.inVerticalRange(e)&&this.inHorizontalRange(e)}};for(h=0,v=t.length;h<v;h++){s=t[h];f(s)}return e(t,n)};e=function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;t=e[0].spine;f=w(t);a=t.data("ups");r=t.data("downs");for(h=0,m=e.length;h<m;h++){o=e[h];if(o.isExpanded){o._marginLeft=o.expanded.marginLeft;o._width=o.expanded.width;o._height=o.expanded.height}else{o._marginLeft=o.collapsed.marginLeft;o._width=o.collapsed.width;o._height=o.collapsed.height}}l=function(e){var t,n,r,i,s;i=T(e.start);n=Math.floor((e.leftPctNum-parseFloat(e.leftmost()))/f.pctPerInterval())+1;s=Math.floor((parseFloat(e.rightmost())-e.leftPctNum)/f.pctPerInterval())+1;r=new Date(i);r.setDate(i.getDate()-n);i.setDate(i.getDate()+s);t=[];while(r<=i){t.push(A(r));r.setDate(r.getDate()+1)}return e.priority=Math.max.apply(Math,t)};for(p=0,g=e.length;p<g;p++){o=e[p];l(o)}c=function(e){var t;t=0;if(e.up){switch(e.priority){case 3:t=-35;break;case 2:t=-30;break;case 1:t=-23}t=t-parseFloat(e._height)}else{switch(e.priority){case 3:t=20;break;case 2:t=16;break;case 1:t=12}}return e._top=t};for(d=0,y=e.length;d<y;d++){o=e[d];c(o)}n=function(e,t){var r;r=function(){var n,r,i;i=[];for(n=0,r=t.length;n<r;n++){o=t[n];if(e.clash(o)){i.push(o)}}return i}();if(r.length>0){if(!o.up){e._top=r[0]._top+8+e._height}else{e._top=r[0]._top-8-e._height}return n(e,t)}};u=function(e){var t,r,i,s,u;u=[];for(t=i=0,s=e.length;i<s;t=++i){o=e[t];u.push(n(o,function(){var t,n,i;i=[];for(n=0,t=e.length;n<t;n++){r=e[n];if(r!==o){i.push(r)}}return i}()))}return u};u(a);u(r);for(v=0,b=e.length;v<b;v++){o=e[v];M(o)}s=function(e){var t,n,r,i;t=0;for(i=0,r=e.length;i<r;i++){o=e[i];n=parseFloat(o._top);if(t>n){t=n}}return Math.abs(t)};i=function(e){var t,n,r,i;n=0;for(i=0,r=e.length;i<r;i++){o=e[i];t=parseFloat(o._top+o._height);if(n<t){n=t}}return n};if(e[0]!=null){e[0].spine.parent().animate({height:2*Math.max(s(e),i(e))+8},{duration:200})}return e};M=function(e){var t,n,r,i;t=e.lblContainer;t.animate({height:e._height,width:e._width,marginLeft:e._marginLeft,top:e._top+"px"},{duration:200});if(e.vertical!=null){n=e.top()+e.lblHeight()/2;r=Math.abs(n);if(e.up){i=n}else{i=0}e.vertical.animate({top:i,height:r},{duration:200});e.horizontal.animate({top:n},{duration:200})}if(e.startWire.height()!==0){return e.animateStartWire()}};i=function(t,r,i){return t.data("clicked",true).click(function(){var s,o,u,a,f,l,c,h,p;s=t.data("clicked");u=function(){var e,t,n;n=[];for(e=0,t=r.length;e<t;e++){o=r[e];if(!o.isExpanded){n.push(o)}}return n}();for(a=0,c=r.length;a<c;a++){o=r[a];o.isExpanded=s}if(s){e(r);for(f=0,h=u.length;f<h;f++){o=u[f];n(o,w(i))}}else{e(r);for(l=0,p=r.length;l<p;l++){o=r[l];o.removeEndWires()}}return t.data("clicked",!s)})};x=function(e){return"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Aug,Nov,Dec".split(",")[e]};O=function(e){return e.sort(function(e,t){if(T(e.start)<T(t.start)){return-1}else{return 1}})};y=function(e){return e.parent()};w=function(e){if(e.hasClass("spine")){return e.parent().data("utils")}else{return e.data("utils")}};b=function(){return"timeline_"+$(".timeline").length+1};T=function(e){var t;if(e.getDate!=null){return e}t=e.match(/(\d+)/g);return new Date(t[0],t[1]-1,t[2])};d=function(e){var t;e.append(t=$(document.createElement("div")));return t.attr({id:b(),"class":"timelineContainer"}).css({position:"relative",minWidth:"500px",minHeight:"150px",height:"auto",width:"100%",backgroundColor:"white"})};g=function(e,t,n,r){var i,s,o;i=7;s=3;o=$(document.createElement("div")).data({leftBuffer:i,rightBuffer:s});e.append(o);o.data("widthPct",100-(s+i));o.attr({"class":"spine"}).css({position:"absolute",width:"0%",height:"1px",top:"50%","margin-left":i+"%","margin-right":s+"%",backgroundColor:"black"}).animate({width:100-(s+i)+"%"},{duration:1e3,complete:function(){return o.find(".intMarker").delay(800).fadeIn(600)}});return n(o,t,r)};m=function(e){var t,n;n=y(e);t=E(12,"black").addClass("originCircle").css({opacity:0,cursor:"pointer",top:"50%",left:e.data("leftBuffer")+"%"}).animate({opacity:1},{duration:"300"});n.data("originCircle",t).append(t);return e};E=function(e,t,n){var r;if(n==null){n=true}o(r=$(document.createElement("div")).css({background:t,zIndex:10,height:e+"px",width:e+"px",position:"absolute","-moz-border-radius":e+"px","-webkit-border-radius":e+"px"}));if(n){r.css({"-webkit-box-shadow":"0 0 1px black","-moz-box-shadow":"0 0 1px black",boxShadow:"0 0 1px black"})}return r};o=function(e){return e.css({"margin-top":-e.height()/2+"px","margin-left":-e.width()/2+"px"})};t=function(e,t,n){return e.animate({height:t+"px",width:t+"px","-moz-border-radius":t+"px","-webkit-border-radius":t+"px","margin-top":-t/2+"px","margin-left":-t/2+"px"},{duration:n})};v=function(e,t,n){var r,i,o,u,a,f,l,c,h,p,d,v,m;p=new Date;i=function(e){var t;switch(e.priority){case 3:t={w:3,h:19,c:"black"};break;case 2:t={w:2,h:11,c:"black"};break;case 1:t={w:1,h:5,c:"black"}}if(e.date===p.getDate()&&e.month===p.getMonth()){t.c="blue";if(t.h<15){t.h=15}}return t};d=w(y(e));o=d.markerLeftBuffer;c=d.pctPerInterval();for(u=v=0,m=t.length;v<m;u=++v){a=t[u];h=3+u*c+"%";(l=S(i(a))).css({left:h});e.append(l);r=function(e){var t;t=e.data("finalHeight");return e.delay(1200).animate({height:t,marginTop:-t/2},{duration:300})};r(l);f=s(a);if(f!=null){e.append(f.css("left",h));f.hide()}}return n(e)};S=function(e){var t,n;t=e["h"];n=e["w"];return $(document.createElement("div")).css({position:"absolute",top:0,marginTop:0,"margin-left":-n/2,height:0,width:n,backgroundColor:e["c"]}).data("finalHeight",t)};s=function(e){var t,n;t=$(document.createElement("div")).css({marginTop:-20,width:40,marginLeft:-20,textAlign:"center",height:"auto",fontFamily:"Helvetica Neue",fontSize:"7px",position:"absolute"}).addClass("intMarker");n="";switch(e.priority){case 3:n=x(e.month);t.css({marginTop:-28,fontSize:9,fontWeight:"bold"});break;case 2:n="Mon "+e.date;break;case 1:return null}return t.text(n)};u=function(e,t){var n,r,i,s;s=w(t);i=s.dateToMarkerLeft(T(e.start));n=s.dateToMarkerLeft(T(e.end));t.append((e.startDot=E(7,"#47ACCA")).delay(1400).css({left:0,zIndex:10}).animate({left:i},{duration:400}));t.append((e.endDot=E(7,"#E0524E")).delay(1400).css({left:0,zIndex:11}).animate({left:n},{duration:400}).hide());t.append(e.duration=l(e,w(t),"#5BB35C"));t.append(r=E(14,"white").css({opacity:0,left:i}));return e.hoverAnimation={"in":e.duration.data("slideIn"),out:e.duration.data("slideOut")}};l=function(e,t,n){var r,i,s,o;r=t.dateToMarkerLeft(T(e.start));s=t.dateToMarkerLeft(T(e.end));o=parseFloat(s)-parseFloat(r)+"%";return i=$(document.createElement("div")).css({height:2,width:0,position:"absolute",left:r,zIndex:5,backgroundColor:n}).data({slideIn:function(){if(!i.hasClass("inTransition")){i.addClass("inTransition").stop().css("width",0).animate({width:o},{duration:300,complete:function(){return i.removeClass("inTransition")}});return e.endDot.fadeIn(300)}},slideOut:function(){var t;t=0;if(i.hasClass("inTransition")){t=200}e.endDot.delay(t).stop().fadeOut(300);return i.delay(t).stop().addClass("inTransition").animate({width:0},{duration:300}).removeClass("inTransition")}})};a=function(t,r){var i,s;s=w(r).dateToMarkerLeft(t.start);r.append(i=$(document.createElement("div")));i.addClass("infoBox").css("left",s).click(function(){t.isExpanded=!t.isExpanded;e(r.data("moments"));if(t.isExpanded){return n(t,w(r))}else{return t.removeEndWires()}}).hover(t.hoverAnimation["in"],t.hoverAnimation.out);C(t,i,w(r).structure,w(r)).hide();i.css("margin-left",-i.width()/2).data("defaultLeft",s);t.leftPctNum=parseFloat(s);f(t,r,s);t.lblContainer=i;return t};f=function(e,t,n){var r;t.append(r=$(document.createElement("div")));r.addClass("wire").css({position:"absolute",width:"2",backgroundColor:"black",left:n,top:0,"-webkit-box-shadow":"0 0 2px blue",height:0,"-moz-box-shadow":"0 0 2px blue",boxShadow:"0 0 2px blue"});e.startWire=r;return e.animateStartWire=function(){if(this.up){return this.startWire.stop().animate({height:Math.abs(this.bottom()),top:this.bottom()},{duration:200,easing:"linear"})}else{return this.startWire.animate({height:this.top()},{duration:200})}}};C=function(e,t,n,r){var i,s,o,u,a,f;u="";if(n.title.length!==1){for(i=a=0,f=n.title.length-2;0<=f?a<=f:a>=f;i=0<=f?++a:--a){s=n.title[i];if(e[s]!=null){u+=e[s]+":"}}}u+=e[n.title[n.title.length-1]];o=$(document.createElement("span")).css("display","inline").text(u).addClass("title").appendTo(t);e.collapsed={height:t.height(),width:t.width()+1,marginLeft:-t.width()/2};return N(e,o,t,n,r,u)};N=function(e,t,n,r,i,s){var o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E;if(r.extendedTitle.length!==0){s+=" - ";for(a=p=0,b=r.extendedTitle.length-2;0<=b?p<=b:p>=b;a=0<=b?++p:--p){f=r.extendedTitle[a];if(e.key!=null){s=s+e[f]+", "}}s+=e[r.extendedTitle[r.extendedTitle.length-1]];if(/^[\s]+$/.test(s.split(" - ")[1])){s=s.replace(" - ","")}}t.text(s);s="";n.html(n.html()+"<br>");u=$(document.createElement("span")).css({whiteSpace:"nowrap",fontSize:"10px",fontFamily:"'Helvetica Neue', Helvetica, Arial, sans-serif"}).appendTo(n);o=false;if(r.content.names!=null){h=[];w=r.content.links;for(a=d=0,g=w.length;d<g;a=++d){c=w[a];if(e[c]!=null){l=$(document.createElement("a"));l.text(r.content.names[a]).attr("href",e[c]);h.push(l)}}o=h.length!==0;for(a=v=0,y=h.length;v<y;a=++v){l=h[a];if(a!==h.length-1){l.appendTo(u);u.html(u.html()+" / ")}}if(h[0]!=null){u.append(l)}}else{for(a=m=0,E=r.content.length-2;0<=E?m<=E:m>=E;a=0<=E?++m:--m){f=r.content[a];if(e[f]!=null){s+=e[f]+" / "}}s+=e[r.content[r.content.length-1]];o=true;u.text(s)}e.expanded={height:n.height()+(o?4:0),width:n.width()+(o?4:0),marginLeft:e.collapsed.marginLeft};return n.css({height:e.collapsed.height,width:e.collapsed.width,marginLeft:e.collapsed.marginLeft})};n=function(e,t){var n,r,i,s,o,u;i=e.startWire;n=$(i).attr("style").split("left:")[1].split("%")[0]+"%";r=parseFloat(t.dateToMarkerLeft(e.end));s=e.top()+e.lblHeight()/2;o=Math.abs(s);if(e.up){u=s}else{u=0}e.vertical=$(document.createElement("div")).css({position:"absolute",width:"2px",backgroundColor:"black",left:r+"%",height:0,top:s,"-webkit-box-shadow":"0 0 2px red","-moz-box-shadow":"0 0 2px red",boxShadow:"0 0 2px red"}).appendTo(e.spine);e.horizontal=$(document.createElement("div")).css({position:"absolute",height:"2px",backgroundColor:"black",left:n,width:0,top:s,"-webkit-box-shadow":"0 0 2px red","-moz-box-shadow":"0 0 2px red",boxShadow:"0 0 2px red"}).appendTo(e.spine);e.horizontal.animate({width:r-parseFloat(n)+"%"},{complete:function(){return e.vertical.animate({height:o,top:u},{duration:200})}});return e.removeEndWires=function(){e.vertical.remove();return e.horizontal.remove()}}}).call(this)